{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "ACM",
      "Effect": "Deny",
      "Action": [
        "acm:DeleteCert*",
        "acm:ExportCert*",
        "acm:RemoveTagsFromCert*",
        "elasticloadbalancing:DeleteLoadBal*",
        "elasticloadbalancing:DeleteTargetG*",
        "elasticloadbalancing:RemoveTags"
      ],
      "Resource": "*",
      "Condition": {
        "StringEquals": {
          "aws:ResourceTag/Accelerator": "${ACCELERATOR_PREFIX}"
        },
        "ArnNotLike": {
          "aws:PrincipalArn": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "ALM",
      "Effect": "Deny",
      "Action": [
        "cloudwatch:DeleteAlarms",
        "cloudwatch:DeleteDashboards",
        "cloudwatch:DisableAlarmActions",
        "cloudwatch:PutDashboard",
        "cloudwatch:PutMetricAlarm",
        "cloudwatch:SetAlarmState"
      ],
      "Resource": [
        "arn:${PARTITION}:cloudwatch:*:*:alarm:${ACCELERATOR_PREFIX}*"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "CON",
      "Effect": "Deny",
      "Action": [
        "config:DeleteAggregationAuthorization",
        "config:DeleteConfigurationRecorder",
        "config:DeleteDeliveryChannel",
        "config:DeleteEvaluationResults",
        "config:DeleteRetentionConfig*",
        "config:PutAggregationAuthorization",
        "config:PutConfigurationAggregator",
        "config:PutConfigurationRecorder",
        "config:PutDeliveryChannel",
        "config:PutRetentionConfig*",
        "config:StopConfigurationRecorder"
      ],
      "Resource": "*",
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "CF",
      "Effect": "Deny",
      "Action": "cloudformation:Delete*",
      "Resource": "arn:aws:cloudformation:*:*:stack/${ACCELERATOR_PREFIX}*",
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "CT",
      "Effect": "Deny",
      "Action": [
        "cloudtrail:CreateTrail",
        "cloudtrail:DeleteTrail",
        "cloudtrail:PutEventSelectors",
        "cloudtrail:PutInsightSelectors",
        "cloudtrail:StopLogging",
        "cloudtrail:UpdateTrail"
      ],
      "Resource": "arn:aws:cloudtrail:*:*:trail/${ACCELERATOR_PREFIX}*",
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "EC21",
      "Effect": "Deny",
      "Action": "ec2:RunInstances",
      "Resource": "*",
      "Condition": {
        "StringLike": {
          "ec2:InstanceType": [
            "*.16xlarge",
            "*.24xlarge",
            "*.32xlarge",
            "*.metal"
          ]
        }
      }
    },
    {
      "Sid": "EC22",
      "Effect": "Deny",
      "Action": "ec2:CreateVolume",
      "Resource": "*",
      "Condition": {
        "StringLike": {
          "ec2:VolumeType": [
            "gp2"
          ]
        }
      }
    },
    {
      "Sid": "EVENT",
      "Effect": "Deny",
      "Action": [
        "events:DeleteRule",
        "events:DisableRule",
        "events:PutRule",
        "events:PutTargets",
        "events:RemoveTargets"
      ],
      "Resource": [
        "arn:${PARTITION}:events:*:*:rule/${ACCELERATOR_PREFIX}*"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "IAM",
      "Effect": "Deny",
      "Action": "iam:*",
      "Resource": [
        "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
        "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}",
            "arn:aws:iam::*:role/AWSServiceRoleForConfig"
          ]
        }
      }
    },
    {
      "Sid": "IAM2",
      "Effect": "Deny",
      "Action": [
        "iam:CreatePolicy",
        "iam:CreatePolicyVersion",
        "iam:DeletePolic*",
        "iam:SetDefaultPolicyVersion"
      ],
      "Resource": "arn:${PARTITION}:iam::*:policy/${ACCELERATOR_PREFIX}*",
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "IMP",
      "Effect": "Deny",
      "Action": "securityhub:DisableImportFindingsForProduct",
      "Resource": [
        "arn:aws:securityhub:*:*:product/amazon/*",
        "arn:aws:securityhub:*:*:product/aws/*"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:aws:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:aws:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    },
    {
      "Sid": "KIN",
      "Effect": "Deny",
      "Action": [
        "firehose:Create*",
        "firehose:Delete*",
        "firehose:Start*",
        "firehose:Stop*",
        "firehose:Update*",
        "kinesis:Create*",
        "kinesis:Decrease*",
        "kinesis:Delete*",
        "kinesis:Deregister*",
        "kinesis:Start*",
        "kinesis:Stop*",
        "kinesis:Update*"
      ],
      "Resource": [
        "arn:${PARTITION}:firehose:*:*:deliverystream/${ACCELERATOR_PREFIX}*",
        "arn:${PARTITION}:kinesis:*:*:stream/${ACCELERATOR_PREFIX}*"
      ],
      "Condition": {
        "ArnNotLike": {
          "aws:PrincipalARN": [
            "arn:${PARTITION}:iam::*:role/${ACCELERATOR_PREFIX}*",
            "arn:${PARTITION}:iam::*:role/${MANAGEMENT_ACCOUNT_ACCESS_ROLE}"
          ]
        }
      }
    }
  ]
}
